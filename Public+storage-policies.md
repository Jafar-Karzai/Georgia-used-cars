| schemaname | tablename              | policyname                                     | roles           | cmd    | qual                                                                                                                                                                                                                                      | with_check                                                                                       |
| ---------- | ---------------------- | ---------------------------------------------- | --------------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| public     | communications         | Authenticated can view communications          | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | communications         | Sales & managers can manage communications     | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'sales_agent'::"UserRole"])))))                                                             | null                                                                                             |
| public     | customers              | Authenticated can view customers               | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | customers              | Sales & managers can manage customers          | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'sales_agent'::"UserRole"])))))                                                             | null                                                                                             |
| public     | expenses               | Authenticated can view expenses                | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | expenses               | Finance & inventory can manage expenses        | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'finance_manager'::"UserRole", 'inventory_manager'::"UserRole"])))))                        | null                                                                                             |
| public     | inquiries              | Authenticated can view inquiries               | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | inquiries              | Sales & managers can manage inquiries          | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'sales_agent'::"UserRole"])))))                                                             | null                                                                                             |
| public     | invoices               | Authenticated can view invoices                | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | invoices               | Finance & managers can manage invoices         | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'finance_manager'::"UserRole"])))))                                                         | null                                                                                             |
| public     | payments               | Authenticated can view payments                | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | payments               | Finance & managers can manage payments         | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'finance_manager'::"UserRole"])))))                                                         | null                                                                                             |
| public     | profiles               | Super admins can manage profiles               | {public}        | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = 'super_admin'::"UserRole"))))                                                                                                                            | null                                                                                             |
| public     | profiles               | Users can update their own profile             | {public}        | UPDATE | (auth.uid() = id)                                                                                                                                                                                                                         | null                                                                                             |
| public     | profiles               | Users can view their own profile               | {public}        | SELECT | (auth.uid() = id)                                                                                                                                                                                                                         | null                                                                                             |
| public     | vehicle_documents      | Authorized can manage documents                | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'inventory_manager'::"UserRole", 'finance_manager'::"UserRole"])))))                        | null                                                                                             |
| public     | vehicle_documents      | Authorized can view documents                  | {authenticated} | SELECT | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'inventory_manager'::"UserRole", 'finance_manager'::"UserRole"])))))                        | null                                                                                             |
| public     | vehicle_photos         | Authenticated can view photos                  | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | vehicle_photos         | Inventory managers can manage photos           | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'inventory_manager'::"UserRole"])))))                                                       | null                                                                                             |
| public     | vehicle_photos         | Public can view photos of public vehicles      | {anon}          | SELECT | (EXISTS ( SELECT 1
   FROM vehicles v
  WHERE ((v.id = vehicle_photos.vehicle_id) AND (COALESCE(v.is_public, false) = true))))                                                                                                            | null                                                                                             |
| public     | vehicle_status_history | Authenticated can view status history          | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | vehicle_status_history | Inventory managers can manage status history   | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'inventory_manager'::"UserRole"])))))                                                       | null                                                                                             |
| public     | vehicles               | Authenticated can view vehicles                | {authenticated} | SELECT | true                                                                                                                                                                                                                                      | null                                                                                             |
| public     | vehicles               | Inventory managers can manage vehicles         | {authenticated} | ALL    | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'manager'::"UserRole", 'inventory_manager'::"UserRole"])))))                                                       | null                                                                                             |
| public     | vehicles               | Public can view public vehicles                | {anon}          | SELECT | (COALESCE(is_public, false) = true)                                                                                                                                                                                                       | null                                                                                             |
| storage    | objects                | Authenticated users can upload vehicle images  | {authenticated} | INSERT | null                                                                                                                                                                                                                                      | ((bucket_id = 'vehicle-images'::text) AND ((storage.foldername(name))[1] = 'vehicles'::text))    |
| storage    | objects                | Authenticated users can view receipts          | {authenticated} | SELECT | (bucket_id = 'receipts'::text)                                                                                                                                                                                                            | null                                                                                             |
| storage    | objects                | Authenticated users can view vehicle documents | {authenticated} | SELECT | (bucket_id = 'vehicle-documents'::text)                                                                                                                                                                                                   | null                                                                                             |
| storage    | objects                | Authorized users can delete vehicle documents  | {authenticated} | DELETE | ((bucket_id = 'vehicle-documents'::text) AND (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'inventory_manager'::"UserRole", 'finance_manager'::"UserRole"])))))) | null                                                                                             |
| storage    | objects                | Authorized users can delete vehicle images     | {authenticated} | DELETE | ((bucket_id = 'vehicle-images'::text) AND (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'inventory_manager'::"UserRole"]))))))                                   | null                                                                                             |
| storage    | objects                | Authorized users can update vehicle documents  | {authenticated} | UPDATE | (bucket_id = 'vehicle-documents'::text)                                                                                                                                                                                                   | null                                                                                             |
| storage    | objects                | Authorized users can upload receipts           | {authenticated} | INSERT | null                                                                                                                                                                                                                                      | ((bucket_id = 'receipts'::text) AND ((storage.foldername(name))[1] = 'expenses'::text))          |
| storage    | objects                | Authorized users can upload vehicle documents  | {authenticated} | INSERT | null                                                                                                                                                                                                                                      | ((bucket_id = 'vehicle-documents'::text) AND ((storage.foldername(name))[1] = 'vehicles'::text)) |
| storage    | objects                | Finance managers can manage receipts           | {authenticated} | ALL    | ((bucket_id = 'receipts'::text) AND (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = auth.uid()) AND (p.role = ANY (ARRAY['super_admin'::"UserRole", 'finance_manager'::"UserRole"]))))))                                           | null                                                                                             |
| storage    | objects                | Users can update their own vehicle images      | {authenticated} | UPDATE | ((bucket_id = 'vehicle-images'::text) AND ((auth.uid())::text = (storage.foldername(name))[2]))                                                                                                                                           | null                                                                                             |
| storage    | objects                | Vehicle images are publicly accessible         | {public}        | SELECT | (bucket_id = 'vehicle-images'::text)                                                                                                                                                                                                      | null                                                                                             |